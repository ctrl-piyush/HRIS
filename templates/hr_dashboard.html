{% extends 'base.html' %}{% block content %}<h2>HR Dashboard</h2><div class="stats"><div class="stat card"><h3>Total Employees</h3><div class="stat-value">{{ total_employees }}</div></div><div class="stat card"><h3>Pending Payroll</h3><div class="stat-value">{{ pending_payroll }}</div></div><div class="stat card"><h3>Avg Salary</h3><div class="stat-value">₹ {{ avg_salary }}</div></div><div class="stat card"><h3>At-risk by ML</h3><div class="stat-value">{{ risk_count }}</div></div></div><div class="panel"><h3>Payroll Analytics</h3><canvas id="payrollChart" height="120"></canvas></div><div class="panel"><h3>Employees</h3><table class="table"><thead><tr><th>ID</th><th>Name</th><th>Dept</th><th>Salary</th><th>Tenure</th><th>Absences</th><th>Salary Pending</th><th>ML Risk</th><th>Action</th></tr></thead><tbody>{% for e in employees %}{% set pred = (preds | selectattr('employee_id','equalto', e.employee_id) | list)[0] %}<tr><td>{{ e.employee_id }}</td><td>{{ e.name }}</td><td>{{ e.department }}</td><td>₹ {{ e.salary }}</td><td>{{ e.tenure_years }}</td><td>{{ e.absence_count }}</td><td>{{ 'Yes' if e.salary_pending else 'No' }}</td><td>{{ 'At Risk' if pred.risk else 'OK' }}</td><td><a class="btn small" href="{{ url_for('employee_view', eid=e.employee_id) }}">View</a></td></tr>{% endfor %}</tbody></table></div><script>const payroll = {{ payroll|tojson }};const employees = {{ employees|tojson }};const labels = payroll.map(p=>p.employee_id);const amounts = payroll.map(p=>p.amount);const ctx = document.getElementById('payrollChart').getContext('2d');new Chart(ctx, {type: 'bar',data: {labels: labels,datasets: [{ label: 'Payroll Amount', data: amounts }]}});</script>{% endblock %}